double ran();
double prob_dens_fpt__absorb_unit_circle_r0_eq_0(const double t);

double rand_fpt__absorb_circle_r0_eq_0(const double D,const double R)
{
   static const int og=263;
   static const int og_p_eins=264;
   static const double Q=3.886174797133122684152587136140e-03;
   
   
   static const double x[]={ 0    , 3.000000000000000000000000000000e-02, 3.820033693650311718061903487705e-02, 4.316046223252084885956250505039e-02, 4.687265555722606949119272735204e-02, 4.992248707480965565360431403502e-02, 5.255935642703189200735790301104e-02, 5.491273884820511387335974052070e-02, 5.705870705260991971407390566662e-02, 5.904591256552366185661186603003e-02, 6.090745108690120577826950721870e-02, 6.266691819066973741964628147285e-02, 6.434176840782984816518947667284e-02, 6.594530334473046609381656122860e-02, 6.748791114775894185120197191261e-02, 6.897787285991226055914671395133e-02, 7.042190600318151327741455989222e-02, 7.182554223282153476842687887336e-02, 7.319339659054469043091093360794e-02, 7.452936383122860919173328098248e-02, 7.583676441892321799399305497759e-02, 7.711845499787999576083672873767e-02, 7.837691328506455811801688639235e-02, 7.961430421593995824292108711535e-02, 8.083253212992808850979324568824e-02, 8.203328240929377301782825445377e-02, 8.321805504578943567236994254495e-02, 8.438819195499365822410879433813e-02, 8.554489939498751143606271798311e-02, 8.668926651314507708908949653619e-02, 8.782228080238986404951257276179e-02, 8.894484106949449834890089589912e-02, 9.005776838463507385418662154352e-02, 9.116181538085024625507402175805e-02, 9.225767419547162684870311907414e-02, 9.334598328672600002468828193993e-02, 9.442733331306896721885418210932e-02, 9.550227222713454877675557756652e-02, 9.657130970808705107131130790425e-02, 9.763492103387208805526618626822e-02, 9.869355047706266569922692114326e-02, 9.974761429368921565513245443771e-02, 1.007975033628743369505257400773e-01, 1.018435855256861178678935587276e-01, 1.028862076639331516899911079451e-01, 1.039256975533044045940474531408e-01, 1.049623655200382971687436968024e-01, 1.059965059259758764921317741929e-01, 1.070283985032453712348465309241e-01, 1.080583095568067015172330320400e-01, 1.090864930505483765301588836072e-01, 1.101131915904903171224588932592e-01, 1.111386373168356316997157375407e-01, 1.121630527150764372311944309925e-01, 1.131866513550480082900270552265e-01, 1.142096385657046967553196665723e-01, 1.152322120524296845833621670476e-01, 1.162545624628635653213430417008e-01, 1.172768634038677013460056889192e-01, 1.182991748470031033474515109283e-01, 1.193216253402575246042502142474e-01, 1.203443872008321978452252847921e-01, 1.213676274551221540408759023753e-01, 1.223915082227328029112538477861e-01, 1.234161870718534452352743532811e-01, 1.244418173486966211609400891786e-01, 1.254685484834214771257766330214e-01, 1.264965262747041587311762915486e-01, 1.275258931548937814613786147454e-01, 1.285567884374946893664900997236e-01, 1.295893485485409811534012141267e-01, 1.306237072432746680936181315679e-01, 1.316599958094017606268832382261e-01, 1.326983432580788534286101475259e-01, 1.337388765036744907978613578238e-01, 1.347817205332531040709067144545e-01, 1.358269985666432001200621116037e-01, 1.368748322078745133870629809304e-01, 1.379253415886999433556242298796e-01, 1.389786455048563534001274539710e-01, 1.400348615456628930707824683724e-01, 1.410941062175057140910121523866e-01, 1.421564950617131590994815185841e-01, 1.432221427672851664063414865344e-01, 1.442911632789042749711777600826e-01, 1.453636699006228102166880912380e-01, 1.464397753955912119959834790322e-01, 1.475195920821657034917181708484e-01, 1.486032319267093045975165001355e-01, 1.496908066333783092970697617510e-01, 1.507824277311665467986195763055e-01, 1.518782066584618294255601608417e-01, 1.529782548453527777789556723522e-01, 1.540826837939095466117743423539e-01, 1.551916051566487118576766910714e-01, 1.563051308133805945117840949715e-01, 1.574233729466264784712983112254e-01, 1.585464441157834271003247633618e-01, 1.596744573302056281105163968519e-01, 1.608075261213633189239515068311e-01, 1.619457646142332941998403691664e-01, 1.630892875980687105629433632210e-01, 1.642382105966903245807040222355e-01, 1.653926499384363787212584623590e-01, 1.665527228259040420060836047053e-01, 1.677185474056115780272463066480e-01, 1.688902428377072181922941328750e-01, 1.700679293658480319206144718891e-01, 1.712517283873698812787102117722e-01, 1.724417625238678019289913033133e-01, 1.736381556923048452053766840049e-01, 1.748410331767665305124731408825e-01, 1.760505217009775787220884085749e-01, 1.772667495016975140350434060186e-01, 1.784898464031120245321518208118e-01, 1.797199438923376532909097944423e-01, 1.809571751961584476113325384740e-01, 1.822016753591146207873245251406e-01, 1.834535813230650782160115005617e-01, 1.847130320083478286672484884217e-01, 1.859801683966648453883731362785e-01, 1.872551336158208654641329157121e-01, 1.885380730264489264733746181882e-01, 1.898291343108591458943841248985e-01, 1.911284675641513617744740103001e-01, 1.924362253877367857547817718026e-01, 1.937525629854187865352829470273e-01, 1.950776382621883403038506881397e-01, 1.964116119258955737677471810530e-01, 1.977546475919652067537263020893e-01, 1.991069118913305988465240390862e-01, 2.004685745817685447386399551184e-01, 2.018398086628249751066935848408e-01, 2.032207904945303360418217974247e-01, 2.046116999201126755612301111576e-01, 2.060127203929263990393554976632e-01, 2.074240391078253085954934115938e-01, 2.088458471372199604585062967317e-01, 2.102783395720716091212761486402e-01, 2.117217156680881121796102842353e-01, 2.131761789974012044328538142345e-01, 2.146419376060195786550527999587e-01, 2.161192041773683036653319550156e-01, 2.176081962022423443644012146861e-01, 2.191091361555204064352351900186e-01, 2.206222516800051009604193191817e-01, 2.221477757777766098494886641682e-01, 2.236859470094697390411556201733e-01, 2.252370097019085899020461820637e-01, 2.268012141645591875678312693081e-01, 2.283788169152884171920823617927e-01, 2.299700809159476868837822865393e-01, 2.315752758183320251524266227180e-01, 2.331946782211000118819055568583e-01, 2.348285719382772330236074659346e-01, 2.364772482800060567180258773861e-01, 2.381410063462476892987618515031e-01, 2.398201533341889431054821505071e-01, 2.415150048601562187399973926635e-01, 2.432258852968931845089590531323e-01, 2.449531281271168681017322866967e-01, 2.466970763143297367931618170506e-01, 2.484580826919332470416062337637e-01, 2.502365103717617485052063189778e-01, 2.520327331732350339601028474111e-01, 2.538471360744137898646082582184e-01, 2.556801156863353345253898584431e-01, 2.575320807521080084477724975789e-01, 2.594034526723521527595373245435e-01, 2.612946660586946051167777584109e-01, 2.632061693171529765831525153111e-01, 2.651384252633866666056871197009e-01, 2.670919117719447582588151735512e-01, 2.690671224618078710364647579783e-01, 2.710645674207031348366767983722e-01, 2.730847739708702481011205554587e-01, 2.751282874791738379769775817665e-01, 2.771956722146949977416102113582e-01, 2.792875122571951143209567838983e-01, 2.814044124601303556115709684535e-01, 2.835469994722081987607115217246e-01, 2.857159228218212180776287965622e-01, 2.879118560690714685787892547304e-01, 2.901354980305150872181138787876e-01, 2.923875740822155737407790709682e-01, 2.946688375472005586560698884964e-01, 2.969800711739763171518904383461e-01, 2.993220887133731877699976655107e-01, 3.016957366016805987825252017071e-01, 3.041018957587907691500302882940e-01, 3.065414835109146394459399350022e-01, 3.090154556483728087948675155735e-01, 3.115248086300103205034952794023e-01, 3.140705819469509101704914265135e-01, 3.166538606597096890964710105636e-01, 3.192757781241414212158287084347e-01, 3.219375189233355465428500428528e-01, 3.246403220244030967358019419027e-01, 3.273854841811625793635759539432e-01, 3.301743636060541191916818907503e-01, 3.330083839372311559557929494657e-01, 3.358890385297404289888101783129e-01, 3.388178951030546603856747305080e-01, 3.417966007810276531242365398397e-01, 3.448268875646679688005189237012e-01, 3.479105782830565476739935828215e-01, 3.510495930733616242185726021136e-01, 3.542459564473444106450630943701e-01, 3.575018050091353838206412696120e-01, 3.608193958975527759231968462184e-01, 3.642011160360214745731339344454e-01, 3.676494922844581565819798938424e-01, 3.711672026005879997763274935345e-01, 3.747570883333752561026237641808e-01, 3.784221677889768250369824150487e-01, 3.821656512303396836485000825647e-01, 3.859909574958364364364522314841e-01, 3.899017324508715970832950230188e-01, 3.939018695200553109219032672437e-01, 3.979955325873891000804409746315e-01, 4.021871815992459263241395404108e-01, 4.064816012613739351595514629842e-01, 4.108839332887273165870773040308e-01, 4.153997127481548072305003628697e-01, 4.200349091320351948597964208905e-01, 4.247959729198614036287955972408e-01, 4.296898885296570856911723273244e-01, 4.347242347385107119175090455711e-01, 4.399072538698651349132621492475e-01, 4.452479313154366316675180465246e-01, 4.507560872960230194955248981898e-01, 4.564424831867502504250286142445e-01, 4.623189452633446634745700384104e-01, 4.683985093999802676221743885623e-01, 4.746955911108214331557981239182e-01, 4.812261864372936182706464251905e-01, 4.880081106247117983502794142682e-01, 4.950612834207311581348969135303e-01, 5.024080723261324372308980022195e-01, 5.100737084654371255817546425238e-01, 5.180867942506872700000000000000e-01, 5.264799281666856278591122106698e-01, 5.352904805194342654829152849355e-01, 5.445615659257718986951062897868e-01, 5.543432753057015617527156681183e-01, 5.646942546952285748366249871865e-01, 5.756837543338334377691842312204e-01, 5.873943256975784276926734363729e-01, 5.999254272532957830006370948635e-01, 6.133983301615086853631431419152e-01, 6.279629254559804317446595763960e-01, 6.438073835662310692009048280000e-01, 6.611722174283836815827355501792e-01, 6.803713732248490713536323146459e-01, 7.018249780469453227050959636855e-01, 7.261123249019248556477646420336e-01, 7.540619638262798812496537617981e-01, 7.869145212832454741294572766468e-01, 8.266404598680111359327419905905e-01, 8.766253328853645313569156987876e-01, 9.433616387683076881482132947839e-01, 1.041523396328163911568788526017e+00, 1.214665280034638718108718234697e+00, 1.685570225880738293829928816259e+00 };
  
   static const double y[]={ 1.295391599044374228050862378713e-01, 4.739042831074585613042031799001e-01, 7.834831914938041943655395996032e-01, 1.046867567825745617535440679968e+00, 1.274226059612689741896447142634e+00, 1.473783596391693505286964304913e+00, 1.651314619404594798077319839760e+00, 1.810919094307350724249670899971e+00, 1.955597834184253475038908014873e+00, 2.087614493337125265660166917169e+00, 2.208722623349695820418888884095e+00, 2.320311844794426667701142169637e+00, 2.423504912617925469216635478950e+00, 2.519224127807284188286757988414e+00, 2.608238027483776710475921220087e+00, 2.691195015326951613386153488426e+00, 2.768648112003903250219831035891e+00, 2.841073521600504928225825438382e+00, 2.908884798061127455256804550264e+00, 2.972443819981577721726016149039e+00, 3.032069409682518619124569083626e+00, 3.088044186055080560725633441596e+00, 3.140620074194194617966327768181e+00, 3.190022780229108592914446548036e+00, 3.236455459486594099448894427424e+00, 3.280101748996926313276142163154e+00, 3.321128294103637567831511259672e+00, 3.359686868750298664315655453804e+00, 3.395916166649278833726764747370e+00, 3.429943323771724544864132314038e+00, 3.461885219896965005982950241764e+00, 3.491849597241895498484148619310e+00, 3.519936026686792958150790405161e+00, 3.546236746268995186095788750563e+00, 3.570837392026156874045920774766e+00, 3.593817637639342076112825881076e+00, 3.615251756432392810146228030712e+00, 3.635209116962463897015032599287e+00, 3.653754621562336388182113984300e+00, 3.670949095672867899253640588683e+00, 3.686849634560576935873421649147e+00, 3.701509912994335951266092897670e+00, 3.714980462612431427933616017689e+00, 3.727308921012332576479992641466e+00, 3.738540256013186442043535283331e+00, 3.748716968053749175712568468579e+00, 3.757879273278963292936626685306e+00, 3.766065269522902957461173246774e+00, 3.773311087103216966928524503602e+00, 3.779651026093500958898862300004e+00, 3.785117681527904359167451392437e+00, 3.789742057810741226442234845102e+00, 3.793553673448018569928785003443e+00, 3.796580657083576676391454530748e+00, 3.798849835706608507515285202903e+00, 3.800386815796912321709297024283e+00, 3.801216058087019552958402784554e+00, 3.801400000000000000000000000000e+00, 3.801360948493668385465344072878e+00, 3.800843975108834128274627495568e+00, 3.799686854718599229600796511429e+00, 3.797910393810499010080340340382e+00, 3.795534519319068152248923088316e+00, 3.792578328778968697673281996413e+00, 3.789060136850209749327614031241e+00, 3.784997518531998325428350413777e+00, 3.780407349349506584402270297153e+00, 3.775305842769333012635770351259e+00, 3.769708585074186997215181045568e+00, 3.763630567904920258817722313625e+00, 3.757086218658106616401846048304e+00, 3.750089428909625080879031700083e+00, 3.742653581018864203042057503406e+00, 3.734791573054007762026967772620e+00, 3.726515842166183756000043167023e+00, 3.717838386528886920719773738338e+00, 3.708770785948868764271114362648e+00, 3.699324221245496740364231692736e+00, 3.689509492487300636065973490857e+00, 3.679337036166948764358567654859e+00, 3.668816941389140721553880476378e+00, 3.657958965139789585034996352526e+00, 3.646772546699326060092475807611e+00, 3.635266821257929876751137484182e+00, 3.623450632785926357585802503229e+00, 3.611332546208431327623162361258e+00, 3.598920858929543580766052213653e+00, 3.586223611747933811823120814888e+00, 3.573248599202529245484296989189e+00, 3.560003379384114738191026316808e+00, 3.546495283246037674972832094376e+00, 3.532731423444792116993562381570e+00, 3.518718702739046440687231608361e+00, 3.504463821973649400603349327556e+00, 3.489973287673285339737444571741e+00, 3.475253419268735077349720890639e+00, 3.460310355977121266280092171446e+00, 3.445150063356063528473778139774e+00, 3.429778339550328456524203220617e+00, 3.414200821248322695756362841877e+00, 3.398422989364634842754165136126e+00, 3.382450174463775718874518929539e+00, 3.366287561939289376894917319198e+00, 3.349940196961502340217857893975e+00, 3.333412989206340039668579150113e+00, 3.316710717376861740403857742802e+00, 3.299838033528443477106830888332e+00, 3.282799467207868124629175770551e+00, 3.265599429415958613056316165301e+00, 3.248242216402810704952631406205e+00, 3.230732013304142271603040335098e+00, 3.213072897626773515169885388750e+00, 3.195268842590784234652947764331e+00, 3.177323720335457418808371897556e+00, 3.159241304995710782960133426742e+00, 3.141025275655337163410262039073e+00, 3.122679219183018939247179351724e+00, 3.104206632956749028344920312999e+00, 3.085610927481979814132441969230e+00, 3.066895428908530051027020453821e+00, 3.048063381451006942690560999862e+00, 3.029117949717244875610312529129e+00, 3.010062220949022511833209972752e+00, 2.990899207179094984700285663561e+00, 2.971631847308366772501438051593e+00, 2.952263009106832498758279553718e+00, 2.932795491141726548602505412675e+00, 2.913232024636147189238001904706e+00, 2.893575275261256090559242674375e+00, 2.873827844864999067447061896202e+00, 2.853992273140147867310878567987e+00, 2.834071039234325311608457081295e+00, 2.814066563304546518358254033249e+00, 2.793981208018686774114802795504e+00, 2.773817280006171415446430546295e+00, 2.753577031260074382596926948048e+00, 2.733262660492709514081372769012e+00, 2.712876314446701781807839750971e+00, 2.692420089163434170078651781746e+00, 2.671896031210679451450364033602e+00, 2.651306138871144403824471474684e+00, 2.630652363293576763487292799798e+00, 2.609936609608012155049896174937e+00, 2.589160738006669136630297197984e+00, 2.568326564791935119497838552693e+00, 2.547435863392824053969028700506e+00, 2.526490365351228220613065131239e+00, 2.505491761279231044621751763952e+00, 2.484441701788695391274067406169e+00, 2.463341798394292143638509162097e+00, 2.442193624391086863228699626880e+00, 2.420998715707757854171970219226e+00, 2.399758571736476865560220472935e+00, 2.378474656140443858553819306067e+00, 2.357148397640029627071686096628e+00, 2.335781190778444494699895198081e+00, 2.314374396667817725187037727663e+00, 2.292929343716540596858803047243e+00, 2.271447328338696227377721095317e+00, 2.249929615646371126773127982507e+00, 2.228377440125617043037735851062e+00, 2.206792006296806892350764268228e+00, 2.185174489360105388629734089020e+00, 2.163526035826753365049751028805e+00, 2.141847764136844680762232576429e+00, 2.120140765264256003673516054497e+00, 2.098406103309372636333647418894e+00, 2.076644816080237895602645241771e+00, 2.054857915662739364271672613950e+00, 2.033046388980432608620603163740e+00, 2.011211198344591712742795617021e+00, 1.989353281995066239970284521252e+00, 1.967473554632516024958396138656e+00, 1.945572907942588568189379397661e+00, 1.923652211112598800107399601601e+00, 1.901712311341267669093730855521e+00, 1.879754034342074463487627370100e+00, 1.857778184840778094812534729704e+00, 1.835785547067664855285491351645e+00, 1.813776885245084543416790694231e+00, 1.791752944070843472806268601885e+00, 1.769714449198031909177554095203e+00, 1.747662107711875112402702374903e+00, 1.725596608604211615173636201690e+00, 1.703518623246219901472142775347e+00, 1.681428805860035545748529459380e+00, 1.659327793989925468662044770090e+00, 1.637216208973714635313038151472e+00, 1.615094656415193698801456172541e+00, 1.592963726658274268938079636654e+00, 1.570823995263702226959557620815e+00, 1.548676023489189457442513168527e+00, 1.526520358773881267373070045871e+00, 1.504357535228141457034886015180e+00, 1.482188074129710471169073625305e+00, 1.460012484427375410703126078521e+00, 1.437831263253385213904099411804e+00, 1.415644896445951507647458158641e+00, 1.393453859083297202508210716353e+00, 1.371258616030852848532749712061e+00, 1.349059622503357389152480702490e+00, 1.326857324643797930896428330142e+00, 1.304652160121325610917536234172e+00, 1.282444558750515240993145171747e+00, 1.260234943134599404931614611632e+00, 1.238023729335608094634064715285e+00, 1.215811327574688678626276312341e+00, 1.193598142966274950970098214325e+00, 1.171384576290226419549304085600e+00, 1.149171024806579596468938540797e+00, 1.126957883118153426008565288536e+00, 1.104745544086944933576804844917e+00, 1.082534399811055219812215890128e+00, 1.060324842669819882110495596513e+00, 1.038117266445905695741932708093e+00, 1.015912067534405779739740464772e+00, 9.937096462504535012847599755087e-01, 9.715104082486236368030242701768e-01, 9.493147660694498742436061189330e-01, 9.271231408308245029126784822217e-01, 9.049359640849378370016667578024e-01, 8.827536798648590275011199119914e-01, 8.605767469489776464489750438321e-01, 8.384056413764682403862492940563e-01, 8.162408592528981650928719598797e-01, 7.940829198923125829394611690780e-01, 7.719323693509043962668236170475e-01, 7.497897844181003742804919672065e-01, 7.276557771440678663377319594233e-01, 7.055309999989157702595998113064e-01, 6.834161517790702611204302167681e-01, 6.613119844015530767131882094620e-01, 6.392193107586343323026677501430e-01, 6.171390138455114021779466055983e-01, 5.950720574248820813207442430763e-01, 5.730194985580568455585307849249e-01, 5.509825024174065026802407833366e-01, 5.289623599061148125571274820336e-01, 5.069605087576747716005527268972e-01, 4.849785589824192888675035953895e-01, 4.630183237903055311471904883628e-01, 4.410818574752295178768475286300e-01, 4.191715022360345693695690038251e-01, 3.972899465922455001661906936943e-01, 3.754402990179947632338268604967e-01, 3.536261818037131013914379682824e-01, 3.318518521789991331089934244226e-01, 3.101223607401093129643421221704e-01, 2.884437617942130519965940887328e-01, 2.668233973248944373971045337464e-01, 2.452702875725958647621335635473e-01, 2.237956797043249875942570471474e-01, 2.024138372713542281835096905779e-01, 1.811432078365933557788293246140e-01, 1.600082059328088589311208178212e-01, 1.390420394213662007027338398379e-01, 1.182913933633240780406573853302e-01, 9.782461876491487127209225183718e-02, 7.774701749835291061864889634166e-02, 5.823179370985191524098180784005e-02, 3.958949894273688804244872106045e-02, 2.244503013332871263116788538445e-02, 8.252567384168431108314177767788e-03 } ;
   

    if (D==0.0) return 1e200;


    double zu;
    double zu_reject;
    int index;
    double t_candidat;
    double abso_d_y_index;
    
    do
    {
      zu=ran();
      index= (int) (og_p_eins*zu);
          
      zu_reject=ran();

      if(index<og)
      {
       t_candidat=Q*(og_p_eins*zu-index)/y[index]+x[index]; 
       
       if(zu_reject<0.97)
       {
          if((t_candidat<0.445) && (t_candidat>0.0691)) {return t_candidat*R*R/D;};

          if(zu_reject<0.90)
          {
              if((t_candidat<0.679) && (t_candidat>0.0528)) {return t_candidat*R*R/D;};
              if(((t_candidat<0.0528) && (t_candidat>0.02)) && ((t_candidat-0.02)*27.0>zu_reject)) {return t_candidat*R*R/D;};
              


          }//zu_reject<0.9



       }//zu_reject<0.97
       
       
       
       
       abso_d_y_index=prob_dens_fpt__absorb_unit_circle_r0_eq_0(t_candidat)/y[index];
                     
      }
      else
      {
        if (index==og_p_eins)
        {
           t_candidat=5.0;
           abso_d_y_index=0.0;
        }
        else // also index==og
        {
            t_candidat=(og_p_eins*zu*(1.0-x[og])-og+og*x[og]+x[og])/(og_p_eins*(1.0-zu));
            const double save_computation_time=t_candidat+1.0-x[og];
            //y[og]=Q/(save_computation_time*save_computation_time); //wichtig!!!
            //abso_d_y_index=prob_dens_fpt__absorb_unit_sphere_r0_eq_0(t_candidat)/y[index];
            abso_d_y_index=prob_dens_fpt__absorb_unit_circle_r0_eq_0(t_candidat)/Q*(save_computation_time*save_computation_time);
            
        }

      }

      if (abso_d_y_index>1.0)
      {
        std::cout<<"FEHLER in \"rand_fpt__absorb_circle_r0_eq_0\"  zu="<<zu<<"  => abso_d_y_index="<<abso_d_y_index<<std::endl;
        abort();
      }

      if (abso_d_y_index>=zu_reject) return (t_candidat*R*R/D);

    }while(true);

}
